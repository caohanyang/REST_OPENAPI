<!DOCTYPE html>
<html dir="ltr" lang="en" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <link href="https://msdn.microsoft.com/en-us/library/ff701729.aspx" rel="canonical"/>
  <title>
   Geocode Dataflow Sample Code
  </title>
  <meta content="/en-us/library/ff701729(d=default,l=en-us,v=msdn.10).aspx" name="DCS.dcsuri"/>
  <meta content="https://msdn.microsoft.com/en-us/library/ff701729(d=default,l=en-us,v=msdn.10).aspx" name="NormalizedUrl"/>
  <meta content="https://msdn.microsoft.com/en-us/library/ff701729(d=default,l=en-us,v=msdn.10).aspx" name="ms.normalizedurl"/>
  <meta content="na" name="ms.devlang"/>
  <meta content="article" name="ms.topic"/>
  <meta content='{"layout.limit_max_width":true,"AmbientContextId":"3B0E9208-40B4-467A-9E36-77EC2EDC28F2","display.use_large_font":true,"insight.perf_timing":true,"AmbientContextDownstream":{"LogTrace":false},"display.high_contrast":false,"insight.use_wedcs_vnext":true}' name="AmbientContext"/>
  <meta content="https://msdn.microsoft.com/en-us/library/ff701729(d=default,l=en-us,v=msdn.10).aspx" name="VotingContextUrl"/>
  <meta content="FB361395-6:48:43 AM" name="MN"/>
  <meta content="ff701729" name="Search.ShortId"/>
  <meta content="ff701729" name="ms.shortidmsdn"/>
  <meta content="en-us" name="ms.locale"/>
  <meta content="MSDN.10" name="ms.prodver"/>
  <meta content="EN" name="ms.contentlang"/>
  <meta content="EN" name="ms.lang"/>
  <meta content="US" name="ms.loc"/>
  <meta content="2016.12.05.1" name="ms.sitever"/>
  <meta content="48b41da1-8392-4e26-b17f-c1dbe0cf18ed" name="ms.assetid"/>
  <meta content="0" name="ms.auth"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <script data-do-not-move="true" type="text/javascript">
   //<![CDATA[
        var AmbientContext = null;

        (function(){
            var root = (function(){return this;}).call(null);

            var GetCookie = function(name){
                var cookies = root.document.cookie ? root.document.cookie.split('; ') : [];
                for (var i = 0; i < cookies.length; i++) {
                    var pos = cookies[i].indexOf('=');
                    if (name === root.decodeURIComponent(cookies[i].slice(0, pos)))
                    {
                        var cookie = cookies[i].slice(pos + 1).replace(/\+/g, ' ');
                        cookie = root.decodeURIComponent(cookie);
                        return cookie;
                    }
                }
            };

            var JsonDeserialize = function(content) {
                return root.JSON && root.JSON.parse ? root.JSON.parse(content) : (new Function('return (' + content + ')'))();
            };

            try {
                AmbientContext = GetCookie('AmbientContext');
                AmbientContext = AmbientContext && JsonDeserialize(AmbientContext);
            } catch(ex) {
            } finally {
                AmbientContext = AmbientContext || null;
            }
        })();
        //]]>
  </script>
  <script data-do-not-move="true" data-provides="jQuery" src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.9.1.min.js" type="text/javascript">
  </script>
  <link href="https://i-msdn.sec.s-msft.com/Combined.css?resources=0:ImageSprite,0:TopicResponsive,0:TopicResponsive.MediaQueries,1:CodeSnippet,1:ProgrammingSelector,1:ExpandableCollapsibleArea,0:CommunityContent,1:TopicNotInScope,1:FeedViewerBasic,1:ImageSprite,2:Header,2:HeaderFooterSprite,2:Header.MediaQueries,3:Banner.MediaQueries,0:Breadcrumbs,0:Breadcrumbs.MediaQueries,0:ResponsiveToc,0:ResponsiveToc.MediaQueries,1:VersionSelector,0:LibraryMemberFilter,2:Footer,2:Footer.MediaQueries,4:NewFooterSock,4:NewFooterSock.MediaQueries,4:LinkList,0:BaseResponsive,5:MsdnResponsive,0:Tables.MediaQueries;/Areas/Library/Content:0,/Areas/Epx/Content/Css:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Epx/Shared/Content:3,/Areas/Epx/Themes/Base/Content:4,/Areas/Library/Themes/Msdn/Content:5&amp;amp;v=8CBEF4CAFD4FCFAA8AEF0174982C6D44" rel="stylesheet" type="text/css"/>
 </head>
 <body class="library ">
  <div id="page">
   <link rel="stylesheet" type="text/css"/>
   <input id="isHeaderBleeding" type="hidden" value="true"/>
   <div class="ltr msdn" dir="ltr" id="ux-header" ms.pgarea="header">
    <header>
     <span id="singleCol">
     </span>
     <span id="doubleCol">
     </span>
     <span id="isMobile">
     </span>
     <div>
      <div class="row topRow" role="banner">
       <div class="top">
        <div class="left">
         <a class="msdnLogoImg" href="https://msdn.microsoft.com/en-us" ms.cmpgrp="mslogo" title="MSDN home">
          <div class="clip70x15">
           <img alt="Microsoft Logo" class="msft-logo" id="msft-logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636164955987254475"/>
          </div>
         </a>
         <div class="GrayPipeDiv clip1x18">
          <img alt="Gray Pipe" class="GrayPipe" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636164955987254475"/>
         </div>
         <a class="DevCenterFullNameNonMegaBlade" href="https://msdn.microsoft.com/en-us">
          Developer Network
         </a>
         <a class="DevCenterFullName" href="https://msdn.microsoft.com/en-us">
          Developer Network
         </a>
         <a class="DevCenterShortName" href="https://msdn.microsoft.com/en-us">
          Developer
         </a>
        </div>
        <div class="right" ms.cmpgrp="aux nav">
         <div aria-label="Profile button" id="signIn">
          <div class="profileImage">
          </div>
          <a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=13&amp;ct=1483454923&amp;rver=6.7.6640.0&amp;wp=mcmbi&amp;wlcxt=msdn%24msdn%24msdn&amp;wreply=https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fff701729.aspx&amp;lc=1033&amp;id=254354&amp;mkt=en-us">
           Sign in
          </a>
         </div>
         <div class="auxNav">
          <div>
           <div data-fragmentname="Subscriptions" id="Fragment_Subscriptions" xmlns="http://www.w3.org/1999/xhtml">
            <a href="https://msdn.microsoft.com/subscriptions/manage/hh442900" id="Subscriptions_2153_1" xmlns="http://www.w3.org/1999/xhtml">
             MSDN subscriptions
            </a>
           </div>
           <div data-fragmentname="GetTools" id="Fragment_GetTools" xmlns="http://www.w3.org/1999/xhtml">
            <a href="http://go.microsoft.com/fwlink/?LinkId=309297&amp;clcid=0x409&amp;slcid=0x409&amp;campaign=o~msft~msdn~gettools-header~dn308572" id="GetTools_2153_3" xmlns="http://www.w3.org/1999/xhtml">
             Get tools
            </a>
           </div>
          </div>
          <div>
          </div>
         </div>
        </div>
       </div>
      </div>
      <div class="row middleRow">
       <div class="expandTop">
        <div class="left">
        </div>
        <div class="right">
        </div>
       </div>
      </div>
     </div>
     <div class="bg_default" id="buttomRowWrapper">
      <div class="row buttomRow bg_default">
       <div class="bottom">
        <div aria-label="header toc" class="left" ms.cmpgrp="main nav" role="navigation">
         <a aria-label="navigation menu" class="menu-icon" href="javascript:void(0)" id="grip" role="button">
         </a>
         <div id="drawer">
          <div class="toc">
           <nav>
            <ul class="navL1">
             <li class="inactive toggle">
              <a aria-expanded="false" href="javascript:void(0)" role="button">
               Downloads
              </a>
              <ul class="navL2">
               <li class="inactive">
                <a href="https://www.visualstudio.com/downloads/download-visual-studio-vs" role="link" title="Visual Studio">
                 Visual Studio
                </a>
               </li>
               <li class="inactive">
                <a href="https://login.microsoftonline.com/common/oauth2/authorize?client_id=499b84ac-1321-427f-aa17-267ca6975798&amp;site_id=501454&amp;response_mode=form_post&amp;response_type=code+id_token&amp;redirect_uri=https%3a%2f%2fapp.vssps.visualstudio.com%2f_signedin&amp;nonce=d8f8ecb3-62" role="link" title="Subscription access">
                 Subscription access
                </a>
               </li>
               <li class="inactive">
                <a href="https://msdn.microsoft.com/microsoft-sdks-msdn" role="link" title="SDKs">
                 SDKs
                </a>
               </li>
               <li class="inactive toggle">
                <a aria-expanded="false" href="javascript:void(0)" role="button" title="Trial software">
                 Trial software
                </a>
                <ul class="navL3">
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/evalcenter" role="link" title="Free downloads">
                   Free downloads
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/officeevaluationresources" role="link" title="Office resources">
                   Office resources
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/sharepoint2013resources" role="link" title="SharePoint Server 2013 resources">
                   SharePoint Server 2013 resources
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/sqlserver2014expressresources" role="link" title="SQL Server 2014 Express resources">
                   SQL Server 2014 Express resources
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/windowsserver2012r2resources" role="link" title="Windows Server 2012 resources">
                   Windows Server 2012 resources
                  </a>
                 </li>
                </ul>
               </li>
              </ul>
             </li>
             <li class="inactive toggle">
              <a aria-expanded="false" href="javascript:void(0)" role="button">
               Programs
              </a>
              <ul class="navL2">
               <li class="inactive toggle">
                <a aria-expanded="false" href="javascript:void(0)" role="button" title="Subscriptions">
                 Subscriptions
                </a>
                <ul class="navL3">
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/msdn-subscriptions-overview" role="link" title="Overview">
                   Overview
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/msdn-subscriptions-administration" role="link" title="Administrators">
                   Administrators
                  </a>
                 </li>
                </ul>
               </li>
               <li class="inactive toggle">
                <a aria-expanded="false" href="javascript:void(0)" role="button" title="Students">
                 Students
                </a>
                <ul class="navL3">
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/imagine/imagine-home" role="link" title="Microsoft Imagine">
                   Microsoft Imagine
                  </a>
                 </li>
                 <li class="inactive">
                  <a href="https://msdn.microsoft.com/microsoftstudentpartners" role="link" title="Microsoft Student Partners">
                   Microsoft Student Partners
                  </a>
                 </li>
                </ul>
               </li>
               <li class="inactive">
                <a href="https://msdn.microsoft.com/applicationbuilder" role="link" title="ISV">
                 ISV
                </a>
               </li>
               <li class="inactive">
                <a href="https://www.microsoft.com/bizspark" role="link" title="Startups">
                 Startups
                </a>
               </li>
               <li class="inactive">
                <a href="https://rewards.msdn.microsoft.com/" role="link" title="TechRewards">
                 TechRewards
                </a>
               </li>
               <li class="inactive">
                <a href="http://events.msdn.microsoft.com/" role="link" title="Events">
                 Events
                </a>
               </li>
              </ul>
             </li>
             <li class="inactive toggle">
              <a aria-expanded="false" href="javascript:void(0)" role="button">
               Community
              </a>
              <ul class="navL2">
               <li class="inactive">
                <a href="https://msdn.microsoft.com/magazine/dd767791" role="link" title="Magazine">
                 Magazine
                </a>
               </li>
               <li class="inactive">
                <a href="https://social.msdn.microsoft.com/forums/" role="link" title="Forums">
                 Forums
                </a>
               </li>
               <li class="inactive">
                <a href="https://blogs.msdn.microsoft.com/" role="link" title="Blogs">
                 Blogs
                </a>
               </li>
               <li class="inactive">
                <a href="http://channel9.msdn.com/" role="link" title="Channel 9">
                 Channel 9
                </a>
               </li>
              </ul>
             </li>
             <li class="inactive current toggle">
              <a aria-expanded="false" href="javascript:void(0)" role="button">
               Documentation
              </a>
              <ul class="navL2">
               <li class="inactive current">
                <a href="https://msdn.microsoft.com/library" role="link" title="APIs and reference">
                 APIs and reference
                </a>
               </li>
               <li class="inactive">
                <a href="https://msdn.microsoft.com/developer-centers-msdn" role="link" title="Dev centers">
                 Dev centers
                </a>
               </li>
               <li class="inactive">
                <a href="https://code.msdn.microsoft.com/" role="link" title="Samples">
                 Samples
                </a>
               </li>
               <li class="inactive">
                <a href="https://msdn.microsoft.com/retiredcontent" role="link" title="Retired content">
                 Retired content
                </a>
               </li>
              </ul>
             </li>
            </ul>
           </nav>
          </div>
         </div>
        </div>
        <div class="right" ms.title="search" role="search">
         <div data-fragmentname="SearchBox" id="Fragment_SearchBox" xmlns="http://www.w3.org/1999/xhtml">
          <div class="SearchBox">
           <form id="HeaderSearchForm" method="get" name="HeaderSearchForm">
            <button aria-label="search finder" class="header-search-button" id="FakeHeaderSearchButton" role="button" type="submit" value="Search">
             <div class="clip16x20" id="search-finder-div">
              <img alt="search finder" class="search-finder" id="search-finder" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636164955987254475"/>
             </div>
            </button>
            <button id="HeaderSearchButton" style="display:none">
            </button>
            <div id="searchSplitter">
            </div>
            <div class="clip16x20" id="searchCloseIconDiv" tabindex="0">
             <img alt="search clear" class="search-clear-x" id="searchCloseIcon" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636164955987254475"/>
            </div>
            <div id="searchTextContainer" style="width: 0;">
             <input aria-label="search edit textbox" id="HeaderSearchTextBox" maxlength="200" name="query" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" type="text"/>
            </div>
           </form>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
    </header>
   </div>
   <div id="jumpInfo" style="display: none">
    We’re sorry. The content you requested has been removed. You’ll be auto redirected in 1 second.
   </div>
   <link rel="stylesheet" type="text/css"/>
   <link rel="stylesheet" type="text/css"/>
   <div id="breadcrumbs" ms.cmpgrp="breadcrumbs" ms.pgarea="body">
    <div class="breadCrumb" id="breadcrumbDesktop">
     <span class="breadcrumbEllipsis">
      <a href="https://msdn.microsoft.com/en-us/library/dd877180.aspx" title="Maps">
      </a>
     </span>
     <span>
      <a href="https://msdn.microsoft.com/en-us/library/mt670796.aspx" title="Bing Spatial Data Services">
       <span>
        Bing Spatial Data Services
       </span>
      </a>
     </span>
     <span>
      <a href="https://msdn.microsoft.com/en-us/library/ff701734.aspx" title="Bing Spatial Data Services">
       <span>
        Bing Spatial Data Services
       </span>
      </a>
     </span>
     <span class="breadcrumbDropSmall">
      <a href="#" id="breadcrumbDropDownButton" targethref="https://msdn.microsoft.com/en-us/library/ff701734.aspx" title="Geocode Dataflow API">
       <span>
        Geocode Dataflow API
       </span>
      </a>
     </span>
    </div>
    <div id="breadcrumbDropDownMenu">
    </div>
    <div class="breadCrumb" id="breadcrumbTablet">
     <span class="breadcrumbEllipsis">
      <a href="https://msdn.microsoft.com/en-us/library/ff701734.aspx" title="Bing Spatial Data Services">
      </a>
     </span>
     <span>
      <a href="https://msdn.microsoft.com/en-us/library/ff701733.aspx" title="Geocode Dataflow API">
       <span>
        Geocode Dataflow API
       </span>
      </a>
     </span>
     <span class="breadcrumbDropSmall">
      <a href="#" id="tocDropDownButton" title="Sample Code">
       <span>
        Sample Code
       </span>
      </a>
     </span>
    </div>
    <div id="tocDropDownMenu">
    </div>
    <div class="breadCrumb" id="breadcrumbMobile">
     <span class="breadcrumbEllipsis">
      <a href="https://msdn.microsoft.com/en-us/library/ff701733.aspx" title="Geocode Dataflow API">
      </a>
     </span>
     <span class="breadcrumbDropSmall">
      <a href="#" id="tocPopupButton" title="Sample Code">
       <span>
        Sample Code
       </span>
      </a>
     </span>
    </div>
   </div>
   <div id="tocPopupMenu">
    <div class="tocCloseLarge" id="tocPopMenuClose">
    </div>
    <div id="tocTitle">
     Sample Code
    </div>
   </div>
   <div class="" id="body" ms.pgarea="body">
    <span id="tabletView_large">
    </span>
    <span id="tabletView_small">
    </span>
    <span id="mobileView">
    </span>
    <div aria-label="left toc" id="leftNav" ms.cmpgrp="left toc" role="navigation">
     <div class="ArchiveV2" id="tocnav">
      <div class="tocunselected">
       <div id="tocExpandArea">
        <span class="toc_empty">
        </span>
        <span id="tocExpandButton">
         <a aria-label="expand sibling toc" href="javascript:void(0)" role="button">
         </a>
        </span>
       </div>
       <div id="tocExpand">
       </div>
      </div>
      <div class="tocselected">
      </div>
      <div class="tocunselected">
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701737.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Create Job">
         Create Job
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701728.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Get Job Status">
         Get Job Status
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701735.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Download Results">
         Download Results
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701730.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Response Data">
         Response Data
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701731.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Walkthrough">
         Walkthrough
        </a>
       </div>
       <div class="toclevel current" data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701729.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample Code">
         Sample Code
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701736.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Data Schema v1.0">
         Data Schema v1.0
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/jj735477.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Data Schema  v2.0">
         Data Schema  v2.0
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/ff701732.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample Input and Output v1.0">
         Sample Input and Output v1.0
        </a>
       </div>
       <div class="toclevel " data-toclevel="1">
        <a href="https://msdn.microsoft.com/en-us/library/jj735475.aspx" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Sample Input and Output v2.0">
         Sample Input and Output v2.0
        </a>
       </div>
      </div>
      <a href="javascript:void(0)" id="tocMenuToggler" role="button">
       <span aria-expanded="true" aria-label="Table of contents menu" class="tocMenuCollapse" id="tocMenuTogglerIcon" role="button">
       </span>
       <div id="tocMenuTogglerLabel">
        TOC
       </div>
      </a>
     </div>
     <div style="display:none">
      <div id="CollapseLocalizeString">
       Collapse the table of content
      </div>
      <div id="ExpandLocalizeString">
       Expand the table of content
      </div>
     </div>
     <div>
      <a aria-label="Hide Archived Versions" data-exclude-archive="Hide Archived Versions" data-include-archive="Show Archived Versions" href="javascript:void(0)" id="isd_archiveControlResponsive" role="button" style="display:none;">
      </a>
      <div id="isd_archiveInstrument" style="display:none">
       This documentation is archived and is not being maintained.
      </div>
     </div>
    </div>
    <div class="content" id="content" ms.cmpgrp="content body" role="main">
     <div id="archiveDisclaimerText" style="display:none">
      This documentation is archived and is not being maintained.
     </div>
     <div xmlns="http://www.w3.org/1999/xhtml">
      <div class="topic">
       <h1 class="title">
        Geocode Dataflow Sample Code
       </h1>
       <div class="lw_vs">
        <div id="curversion">
         <strong>
          Bing
         </strong>
        </div>
       </div>
       <div style="clear:both;">
       </div>
       <div id="mainSection">
        <div id="mainBody">
         <div class="introduction">
          <p>
           The following sample code uses the Geocode Dataflow to geocode spatial data.
          </p>
          <p>
           <strong>
            Notes:
           </strong>
          </p>
          <ul class="unordered">
           <li>
            <p>
             The code uses the functionality included in Microsoft® .NET 2.0 and is written as a console application.
            </p>
           </li>
           <li>
            <p>
             The code accepts input data in any of the formats supported by the Geocode Dataflow. Examples of supported data formats are XML and CSV(comma-separated values). See
             <a href="https://msdn.microsoft.com/en-us/library/ff701737.aspx">
              Create a Geocode Job and Upload Data
             </a>
             for more information about supported data formats.
            </p>
           </li>
           <li>
            <p>
             The code processes HTTP requests returned in XML format for version 1.0 of the Geocode Dataflow schema.
            </p>
           </li>
           <li>
            <p>
             The results of the geocode job are output to files named succeeded.txt and failed.txt.
            </p>
           </li>
          </ul>
          <div class="codeSnippetContainer" id="code-snippet-1" xmlns="">
           <div class="codeSnippetContainerTabs">
           </div>
           <div class="codeSnippetContainerCodeContainer">
            <div class="codeSnippetToolBar">
             <div class="codeSnippetToolBarText">
              <a href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_7a4b1449-8eb9-4ea9-add6-a1824b47b692');" ms.cmptyp="CodeSnippet" name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard.">
               Copy
              </a>
             </div>
            </div>
            <div class="codeSnippetContainerCode" dir="ltr" id="CodeSnippetContainerCode_7a4b1449-8eb9-4ea9-add6-a1824b47b692">
             <div style="color:Black;">
              <pre>
using System;
using System.IO;
using System.Net;
using System.Text;
using System.Threading;
using System.Xml;


//This C# code sample shows how to geocode data using the Geocode Dataflow REST API.
//For more information on this API, see the Bing Spatial Data Services SDK on MSDN:
// http://msdn.microsoft.com/en-us/library/ff701734.aspx
namespace GeocodeDataFlowExample
{
    //A summary of status information returned in the response when you check 
    // job status. 
    class DownloadDetails
    {
        public string jobStatus { get; set; }
        public string suceededlink { get; set; }
        public string failedlink { get; set; }

    }

    class Program
    {
        //Creates a geocode dataflow job and uploads spatial data to process.
        //Parameters: 
        //   dataFilePath: The path to the file that contains the spatial data to geocode.
        //   dataFormat: The format of the input data. Possible values are xml, csv, tab and pipe.
        //   key: The Bing Maps Key to use for this job. The same key is used to get job status and download results.
        //   description: Text that is used to describe the geocode dataflow job. 
        //Return value : A URL that defines the location of the geocode dataflow job that was created.
        static string CreateJob(string dataFilePath, string dataFormat, string key, string description)
        {
            //Define parameters for the HTTP request
            //
            // The 'Content-Type' header of the HTTP Request must be "text/plain" or "application/xml"
            // depending on the input data format.
            //
            string contentType = "text/plain";
            if (dataFormat.Equals("xml", StringComparison.OrdinalIgnoreCase))
                contentType = "application/xml";

            StringBuilder queryStringBuilder = new StringBuilder();

            //
            // The 'input'(input format) and 'key' (Bing Maps Key) parameters are required.
            //
            queryStringBuilder.Append("input=").Append(Uri.EscapeUriString(dataFormat));
            queryStringBuilder.Append("&amp;");
            queryStringBuilder.Append("key=").Append(Uri.EscapeUriString(key));

            if (!String.IsNullOrEmpty(description))
            {
                //
                // The 'description' parameter is optional.
                //
                queryStringBuilder.Append("&amp;");
                queryStringBuilder.Append("description=").Append(Uri.EscapeUriString(description));
            }

            //Build the HTTP URI that will upload and create the geocode dataflow job
            UriBuilder uriBuilder = new UriBuilder("http://spatial.virtualearth.net");
            uriBuilder.Path = "/REST/v1/dataflows/geocode";
            uriBuilder.Query = queryStringBuilder.ToString();

            //Include the data to geocode in the HTTP request
            using (FileStream dataStream = File.OpenRead(dataFilePath))
            {
                HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uriBuilder.Uri);

                //
                // The HTTP method must be 'POST'.
                //
                request.Method = "POST";
                request.ContentType = contentType;

                using (Stream requestStream = request.GetRequestStream())
                {
                    byte[] buffer = new byte[16384];
                    int bytesRead = dataStream.Read(buffer, 0, buffer.Length);
                    while (bytesRead &gt; 0)
                    {
                        requestStream.Write(buffer, 0, bytesRead);

                        bytesRead = dataStream.Read(buffer, 0, buffer.Length);
                    }
                }

                //Submit the HTTP request and check if the job was created successfully. 
                using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
                {
                    //
                    // If the job was created successfully, the status code should be
                    // 201 (Created) and the 'Location' header should contain a URL
                    // that defines the location of the new dataflow job. You use this 
                    // URL with the Bing Maps Key to query the status of your job.
                    //
                    if (response.StatusCode != HttpStatusCode.Created)
                        throw new Exception ("An HTTP error status code was encountered when creating the geocode job.");

                    string dataflowJobLocation = response.GetResponseHeader("Location");
                    if (String.IsNullOrEmpty(dataflowJobLocation))
                        throw new Exception ("The 'Location' header is missing from the HTTP response when creating a goecode job.");

                    return dataflowJobLocation;
                }
            }
        }


        //Checks the status of a dataflow job and defines the URLs to use to download results when the job is completed.
        //Parameters: 
        //   dataflowJobLocation: The URL to use to check status for a job.
        //   key: The Bing Maps Key for this job. The same key is used to create the job and download results.  
        //Return value: A DownloadDetails object that contains the status of the geocode dataflow job (Completed, Pending, Aborted).
        //              When the status is set to Completed, DownloadDetails also contains the links to download the results
        static DownloadDetails CheckStatus(string dataflowJobLocation, string key)
        {

            DownloadDetails statusDetails = new DownloadDetails();
            statusDetails.jobStatus = "Pending";

            //Build the HTTP Request to get job status
            UriBuilder uriBuilder = new UriBuilder(dataflowJobLocation + @"?key=" + key + "&amp;output=xml");
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uriBuilder.Uri);

            request.Method = "GET";

            //Submit the request and read the response to get job status and to retrieve the links for 
            //  downloading the job results
            //Note: The following conditional statements make use of the fact that the 'Status' field will  
            //  always appear after the 'Link' fields in the HTTP response.
            using (HttpWebResponse response = (HttpWebResponse)request.GetResponse())
            {

                if (response.StatusCode != HttpStatusCode.OK)
                    throw new Exception ("An HTTP error status code was encountered when checking job status.");

                using (Stream receiveStream = response.GetResponseStream())
                {
                    XmlTextReader reader = new XmlTextReader(receiveStream);
                    while (reader.Read())
                    {
                        if (reader.IsStartElement())
                        {
                            if (reader.Name.Equals("Status"))
                            {
                                //return job status
                                statusDetails.jobStatus = reader.ReadString();

                                return (statusDetails);
                            }
                            else if (reader.Name.Equals("Link"))
                            {
                                //Set the URL location values for retrieving 
                                // successful and failed job results
                                reader.MoveToFirstAttribute();
                                if (reader.Value.Equals("output"))
                                {
                                    reader.MoveToNextAttribute();
                                    if (reader.Value.Equals("succeeded"))
                                    {
                                        statusDetails.suceededlink = reader.ReadString();

                                    }
                                    else if (reader.Value.Equals("failed"))
                                    {
                                        statusDetails.failedlink = reader.ReadString();
                                    }
                                }
                            }
                        }
                    }

                }

            }
            return (statusDetails);
        }

        //Downloads job results to files names Success.txt (successfully geocoded results) and 
        //   Failed.txt (info about spatial data that was not geocoded successfully).
         //Parameters: 
        //   statusDetails: Inclues job status and the URLs to use to download all geocoded results.
        //   key: The Bing Maps Key for this job. The same key is used to create the job and get job status.   

        static void DownloadResults(DownloadDetails statusDetails, string key)
        {
            //Write the results for data that was geocoded successfully to a file named Success.xml
            if (statusDetails.suceededlink != null &amp;&amp; !statusDetails.suceededlink.Equals(String.Empty))
            {
                //Create a request to download successfully geocoded data. You must add the Bing Maps Key to the 
                //  download location URL provided in the response to the job status request.
                UriBuilder successUriBuilder = new UriBuilder(statusDetails.suceededlink + @"?key=" + key);
                HttpWebRequest request1 = (HttpWebRequest)WebRequest.Create(successUriBuilder.Uri);

                request1.Method = "GET";

                using (HttpWebResponse response = (HttpWebResponse)request1.GetResponse())
                {
                    if (response.StatusCode != HttpStatusCode.OK)
                        throw new Exception ("An HTTP error status code was encountered when downloading results.");

                    using (Stream receiveStream = response.GetResponseStream())
                    {
                        StreamWriter successfile = new StreamWriter("Success.txt");
                        using (StreamReader r = new StreamReader(receiveStream))
                        {
                            string line;
                            while ((line = r.ReadLine()) != null)
                            {
                                successfile.WriteLine(line);
                            }
                        }
                        successfile.Close();
                    }

                }
            }

            //If some spatial data could not be geocoded, write the error information to a file called Failed.xml
            if (statusDetails.failedlink != null &amp;&amp; !statusDetails.failedlink.Equals(String.Empty))
            {
                //Create an HTTP request to download error information. You must add the Bing Maps Key to the 
                //  download location URL provided in the response to the job status request.
                UriBuilder failedUriBuilder = new UriBuilder(statusDetails.failedlink + @"?key=" + key);
                HttpWebRequest request2 = (HttpWebRequest)WebRequest.Create(failedUriBuilder.Uri);

                request2.Method = "GET";

                using (HttpWebResponse response = (HttpWebResponse)request2.GetResponse())
                {
                    if (response.StatusCode != HttpStatusCode.OK)
                        throw new Exception ("An HTTP error status code was encountered when downloading results.");

                    using (Stream receiveStream = response.GetResponseStream())
                    {
                        StreamWriter failedfile = new StreamWriter("Failed.txt");
                        using (StreamReader r = new StreamReader(receiveStream))
                        {
                            string line;
                            while ((line = r.ReadLine()) != null)
                            {
                                failedfile.WriteLine(line);
                             }
                        }
                        failedfile.Close();
                    }

                }
            }
        }


        //
        // Sample command-line:
        // GeocodeDataFlowExample.exe &lt;dataFilePath&gt; &lt;dataFormat&gt; &lt;key&gt; [&lt;description&gt;]
        //
        // Where:
        // &lt;dataFilePath&gt; is a path to the data file containing entities to geocode.
        // &lt;dataFormat&gt; is one of these types: xml, csv, tab, pipe.
        // &lt;key&gt; is a Bing Maps Key from http://www.bingmapsportal.com.
        // &lt;description&gt; is an optional description for the dataflow job.
        //    


        static void Main(string[] args)
        {
            string dataFilePath = args[0];
            string dataFormat = args[1];
            string key = args[2];
            string description = null;

            try
            {

                if (args.Length &gt; 3)
                    description = args[3];


                string dataflowJobLocation = CreateJob(dataFilePath, dataFormat, key, description);
                Console.WriteLine("Dataflow Job Location: {0}", dataflowJobLocation);

                //Continue to check the dataflow job status until the job has completed
                DownloadDetails statusDetails = new DownloadDetails();
                do
                {
                    statusDetails = CheckStatus(dataflowJobLocation, key);
                    Console.WriteLine("Dataflow Job Status: {0}", statusDetails.jobStatus);
                    if (statusDetails.jobStatus== "Aborted")
                        throw new Exception("Job was aborted due to an error.");
                    Thread.Sleep(30000); //Get status every 30 seconds
                }
                while (statusDetails.jobStatus.Equals("Pending")); 

                //When the job is completed, get the results
                //Two files are created to record the results:
                //  Success.xml contains the data that was successfully geocoded
                //  Failed.mxl contains the data that could not be geocoded

                DownloadResults(statusDetails, key);

            }

            catch (Exception  e)
            {
                Console.WriteLine("Exception :" + e.Message);
            }
         }
    }
}


</pre>
             </div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </div>
     <div class="libraryMemberFilter">
      <div class="filterContainer">
       <span>
        Show:
       </span>
       <label>
        <input checked="checked" class="libraryFilterInherited" type="checkbox" value="Inherit"/>
        Inherited
       </label>
       <label>
        <input checked="checked" class="libraryFilterProtected" type="checkbox" value="Protected"/>
        Protected
       </label>
      </div>
     </div>
     <input id="libraryMemberFilterEmptyWarning" type="hidden" value="There are no members available with your current filter settings."/>
    </div>
    <div id="rightNavigationMenu" ms.cmpgrp="right nav">
     <div id="mobileButtons">
      <div id="navigationButtons">
       <a href="https://msdn.microsoft.com/en-us/library/ff701729(d=printer).aspx" id="isd_print" rel="nofollow">
        <ins class="print">
        </ins>
        Print
       </a>
       <a href="/en-us/library/export/help/?returnurl=%2fen-us%2flibrary%2fff701729.aspx" id="isd_printABook">
        <ins class="export">
        </ins>
        Export (
        <span class="count">
         0
        </span>
        )
       </a>
      </div>
     </div>
     <div id="navMain">
      <div id="closeNavigation">
       <a class="tocCloseSmall" id="closeButton">
       </a>
      </div>
      <div id="navigationButtons">
       <a href="https://msdn.microsoft.com/en-us/library/ff701729(d=printer).aspx" id="isd_print" rel="nofollow">
        <ins class="print">
        </ins>
        Print
       </a>
       <a href="/en-us/library/export/help/?returnurl=%2fen-us%2flibrary%2fff701729.aspx" id="isd_printABook2">
        <ins class="export">
        </ins>
        Export (
        <span class="count">
         0
        </span>
        )
       </a>
       <a aria-expanded="false" href="#" id="isdShare" role="button">
        <ins class="share">
        </ins>
        Share
       </a>
       <div id="socials" style="display: none">
        <a aria-label="Share on Facebook" class="isdFacebook" href="#">
         <ins class="facebook">
         </ins>
        </a>
        <a aria-label="Share on Twitter" class="isdTwitter" href="#">
         <ins class="twitter">
         </ins>
        </a>
        <a aria-label="Share on Google+" class="isdGooglePlus" href="#">
         <ins class="googlePlus">
         </ins>
        </a>
       </div>
      </div>
      <div id="indoc_toc" ms.cmpgrp="indoc toc" style="display: none">
       <div id="indoc_title">
        IN THIS ARTICLE
       </div>
       <ul id="indoc_toclist">
       </ul>
      </div>
     </div>
    </div>
    <div class="rightNavigationMenuThumbnail" id="rightNavigationMenuThumbnail">
    </div>
   </div>
   <div class="clear">
   </div>
   <input name="__RequestVerificationToken" type="hidden" value="TBRpKUY5h-zvPKl1iOj4hj_jCLvTslTj0k4oPbouOFrYhqzL9JESuqUMBEO3sgtJnHHnf5s8Bv-VodLjaXXAA-_QFp01"/>
   <input id="ratingValueSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/rate/ff701729.aspx"/>
   <input id="ratingAdditionalSubmitUrl" type="hidden" value="https://msdn.microsoft.com/en-us/library/feedback/additional/ff701729.aspx"/>
   <input id="isTopicRated" type="hidden" value="false"/>
   <div id="lib-footer">
    <link rel="stylesheet" type="text/css"/>
    <div class="" dir="ltr" id="ux-footer" ms.pgarea="footer" style="">
     <div class="both" id="footerSock">
      <div id="footerSockInner">
       <div class="footerSockLeft">
        <div data-fragmentname="SocialLinks" id="Fragment_SocialLinks" xmlns="http://www.w3.org/1999/xhtml">
         <div class="linkList">
          <div class="linkListTitle">
           Follow us
          </div>
          <ul class="links">
           <li>
            <a class="facebook" href="http://www.facebook.com/microsoftdeveloper" id="SocialLinks_2151_19" target="_blank" xmlns="http://www.w3.org/1999/xhtml">
             http://www.facebook.com/microsoftdeveloper
            </a>
           </li>
           <li>
            <a class="twitter" href="https://twitter.com/msdev" id="SocialLinks_2151_20" target="_blank" xmlns="http://www.w3.org/1999/xhtml">
             https://twitter.com/msdev
            </a>
           </li>
           <li>
            <a class="googlePlus" href="http://plus.google.com/111221966647232053570/" id="SocialLinks_2151_21" target="_blank" xmlns="http://www.w3.org/1999/xhtml">
             http://plus.google.com/111221966647232053570/
            </a>
           </li>
          </ul>
         </div>
        </div>
       </div>
       <div class="footerSockCenter">
        <a name="feedback">
        </a>
        <div class="rating">
         <div id="ratingSection1">
          <div class="title">
           Is this page helpful?
          </div>
          <div class="description">
           Your feedback about this content is important.
           <br/>
           Let us know what you think.
          </div>
          <div class="buttons">
           <button aria-label="Yes, this page was helpful" class="button" id="ratingYes">
            Yes
           </button>
           <button aria-label="No, this page was not helpful" class="button" id="ratingNo">
            No
           </button>
          </div>
          <input id="ratingValue" type="hidden" value=""/>
         </div>
         <div id="ratingSection2">
          <div class="title left">
           Additional feedback?
          </div>
          <textarea cols="" id="ratingText" maxlength="1500" rows="6"></textarea>
          <div class="right">
           <div class="counter">
            <span id="feedbackTextCounter">
             1500
            </span>
            characters remaining
           </div>
           <div class="buttons">
            <button aria-label="Submit my additional feedback" class="button" id="ratingSubmit">
             Submit
            </button>
            <button aria-label="Skip additional feedback" class="button" id="ratingSkipThis">
             Skip this
            </button>
           </div>
          </div>
         </div>
         <div id="ratingSection3">
          <div class="title">
           Thank you!
          </div>
          <div class="description">
           We appreciate your feedback.
          </div>
         </div>
         <div id="contentFeedbackQAContainer" style="display: none;">
         </div>
        </div>
        <div class="userVoice">
         <div class="title">
          Help us improve MSDN.
         </div>
         <div class="description">
          Visit our UserVoice Page to submit and vote on ideas!
         </div>
         <div class="buttons">
          <a class="button" href="https://aka.ms/msdnfeedback" id="userVoiceButton" target="_blank">
           Make a suggestion
          </a>
         </div>
        </div>
       </div>
       <div class="clear">
       </div>
      </div>
     </div>
     <footer aria-label="footer" class="top" role="navigation">
      <div data-fragmentname="LeftLinks" id="Fragment_LeftLinks" xmlns="http://www.w3.org/1999/xhtml">
       <div class="linkList">
        <h4 class="linkListTitle">
         Dev centers
        </h4>
        <ul class="links">
         <li>
          <a class="windowsBlue" href="https://dev.windows.com" id="LeftLinks_2148_1" xmlns="http://www.w3.org/1999/xhtml">
           Windows
          </a>
         </li>
         <li>
          <a class="office" href="http://dev.office.com" id="LeftLinks_2148_3" xmlns="http://www.w3.org/1999/xhtml">
           Office
          </a>
         </li>
         <li>
          <a class="visualStudio" href="https://msdn.microsoft.com/vstudio" id="LeftLinks_2148_4" xmlns="http://www.w3.org/1999/xhtml">
           Visual Studio
          </a>
         </li>
         <li>
          <a href="http://azure.microsoft.com/en-us/documentation/" id="LeftLinks_2148_12" target="_blank" xmlns="http://www.w3.org/1999/xhtml">
           Microsoft Azure
          </a>
         </li>
         <li>
          <a href="https://msdn.microsoft.com/developer-centers-msdn" id="LeftLinks_2148_5" xmlns="http://www.w3.org/1999/xhtml">
           More...
          </a>
         </li>
        </ul>
       </div>
      </div>
      <div id="rightLinks">
       <div data-fragmentname="CenterLinks1" id="Fragment_CenterLinks1" xmlns="http://www.w3.org/1999/xhtml">
        <div class="linkList">
         <h4 class="linkListTitle">
          Learning resources
         </h4>
         <ul class="links">
          <li>
           <a href="http://www.microsoftvirtualacademy.com/" id="CenterLinks1_2151_4" xmlns="http://www.w3.org/1999/xhtml">
            Microsoft Virtual Academy
           </a>
          </li>
          <li>
           <a href="http://channel9.msdn.com/" id="CenterLinks1_2151_5" xmlns="http://www.w3.org/1999/xhtml">
            Channel 9
           </a>
          </li>
          <li>
           <a href="https://msdn.microsoft.com/magazine/" id="CenterLinks1_2151_7" xmlns="http://www.w3.org/1999/xhtml">
            MSDN Magazine
           </a>
          </li>
         </ul>
        </div>
       </div>
       <div data-fragmentname="CenterLinks2" id="Fragment_CenterLinks2" xmlns="http://www.w3.org/1999/xhtml">
        <div class="linkList">
         <h4 class="linkListTitle">
          Community
         </h4>
         <ul class="links">
          <li>
           <a href="https://social.msdn.microsoft.com/forums/en-us/home" id="CenterLinks2_2151_8" xmlns="http://www.w3.org/1999/xhtml">
            Forums
           </a>
          </li>
          <li>
           <a href="http://blogs.msdn.com/b/developer-tools/" id="CenterLinks2_2151_9" xmlns="http://www.w3.org/1999/xhtml">
            Blogs
           </a>
          </li>
          <li>
           <a href="http://www.codeplex.com" id="CenterLinks2_2151_10" xmlns="http://www.w3.org/1999/xhtml">
            Codeplex
           </a>
          </li>
         </ul>
        </div>
       </div>
       <div data-fragmentname="CenterLinks3" id="Fragment_CenterLinks3" xmlns="http://www.w3.org/1999/xhtml">
        <div class="linkList">
         <h4 class="linkListTitle">
          Support
         </h4>
         <ul class="links">
          <li>
           <a href="https://msdn.microsoft.com/hh361695" id="CenterLinks3_2151_11" xmlns="http://www.w3.org/1999/xhtml">
            Self support
           </a>
          </li>
         </ul>
        </div>
       </div>
       <div data-fragmentname="CenterLinks4" id="Fragment_CenterLinks4" xmlns="http://www.w3.org/1999/xhtml">
        <div class="linkList">
         <h4 class="linkListTitle">
          Programs
         </h4>
         <ul class="links">
          <li>
           <a href="https://www.microsoft.com/bizspark/" id="CenterLinks4_2151_13" xmlns="http://www.w3.org/1999/xhtml">
            BizSpark (for startups)
           </a>
          </li>
          <li>
           <a href="https://imagine.microsoft.com/en-us" id="CenterLinks4_2151_22" xmlns="http://www.w3.org/1999/xhtml">
            Microsoft Imagine (for students)
           </a>
          </li>
         </ul>
        </div>
       </div>
      </div>
     </footer>
     <footer class="bottom" role="contentinfo">
      <span class="localeContainer">
       <form action="https://msdn.microsoft.com/en-us/selectlocale-dmc" class="selectLocale" id="selectLocaleForm">
        <input name="fromPage" type="hidden" value="https%3a%2f%2fmsdn.microsoft.com%2fen-us%2flibrary%2fff701729.aspx"/>
        <a href="#" onclick="$('#selectLocaleForm').submit();return false;" title="Change your language">
         United States (English)
        </a>
       </form>
      </span>
      <div data-fragmentname="BottomLinks" id="Fragment_BottomLinks" xmlns="http://www.w3.org/1999/xhtml">
       <div class="linkList">
        <ul class="links horizontal">
         <li>
          <a href="https://msdn.microsoft.com/newsletter.aspx" id="BottomLinks_2148_7" xmlns="http://www.w3.org/1999/xhtml">
           Newsletter
          </a>
         </li>
         <li>
          <a href="https://msdn.microsoft.com/dn529288" id="BottomLinks_2148_8" xmlns="http://www.w3.org/1999/xhtml">
           Privacy &amp; cookies
          </a>
         </li>
         <li>
          <a href="https://msdn.microsoft.com/cc300389" id="BottomLinks_2148_9" xmlns="http://www.w3.org/1999/xhtml">
           Terms of use
          </a>
         </li>
         <li>
          <a href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/" id="BottomLinks_2148_10" xmlns="http://www.w3.org/1999/xhtml">
           Trademarks
          </a>
         </li>
        </ul>
       </div>
      </div>
      <span class="logoLegal">
       <span aria-label="microsoft logo" class="logoSpan clip67x13" role="img" tabindex="0">
        <img alt="logo" class="logo" src="https://i-msdn.sec.s-msft.com/Areas/Centers/Themes/StandardDevCenter/Content/HeaderFooterSprite.png?v=636164955987254475"/>
       </span>
       <span class="copyright">
        © 2017 Microsoft
       </span>
      </span>
     </footer>
    </div>
   </div>
   <div class="footerPrintView">
    <div class="footerCopyrightPrintView">
     © 2017 Microsoft
    </div>
   </div>
   <input id="tocPaddingPerLevel" type="hidden" value="17"/>
   <input id="MtpsDevice" type="hidden" value="Default"/>
   <![CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]>
   <![CDATA[ WebTrends view model not available or IncludeLegacyWebTrendsScriptInGlobal feature flag is off]]>
   <div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="N3c94OLeNlI3YOV6WRn4lvQ0vuFnAXbqkoEwg0c6Qyy66PQ0FQYDTaB9Gs4vPnASr6P_HGQQZRC2LgRUzj5XcBSOESA1"/>
   </div>
  </div>
  <script class="mtps-injected" type="text/javascript">
   /*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"js\": \"https://i2-msdn.sec.s-msft.com\", \r\n\t\"css\": \"https://i-msdn.sec.s-msft.com\", \r\n\t\"ttf\": \"https://i-msdn.sec.s-msft.com\"\r\n});\r\n/**/" },
	{ txt: "//\n\n        window.appInsightsId = \u00275eb1b2eb-c47a-497a-a7ac-a1c230b2882f\u0027;\n        //" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:Utilities,1:Layout,2:Header,3:Breadcrumbs,4:LibraryRightNavigationMenu,4:PrintExportButton,1:Rating,2:Footer,0:Topic,3:ResponsiveSupport,0:AppInsightsPerf,3:ResponsiveToc,0:ABTestControl,4:WEDCS,3:CmpgrpForHeader,1:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Epx/Themes/Base/Content:1,/Areas/Centers/Themes/StandardDevCenter/Content:2,/Areas/Library/Content:3,/Areas/Library/Themes/Base/Content:4\u0026amp;hashKey=6EFE762D58A5F727ACFC660127C79595\u0026amp;v=2B049F20ED0FDB93A4E60305B19BF7D3" },
	{ url: "https://i1.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026minimumTermLength=2\u0026pgArea=header\u0026brand=Msdn\u0026loc=en-us\u0026focusOnInit=false\u0026emptyWatermark=true\u0026searchButtonTooltip=Search MSDN" },
	{ url: "https://i2-msdn.sec.s-msft.com/Combined.js?resources=0:JumpRedirect,1:LibraryMemberFilter,2:Toc_Fixed,0:NewFooterSock,2:CodeSnippet,2:TopicNotInScope,2:VersionSelector,2:SurveyBroker;/Areas/Epx/Themes/Base/Content:0,/Areas/Library/Content:1,/Areas/Epx/Content/Scripts:2\u0026amp;hashKey=FB476E17DDDA1979F675A1D10D867568\u0026amp;v=2B049F20ED0FDB93A4E60305B19BF7D3" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
  </script>
 </body>
</html>
